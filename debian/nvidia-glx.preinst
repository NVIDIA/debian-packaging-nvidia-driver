#!/bin/sh
set -e


# <target: squeeze>
dpkg-maintscript-helper rm_conffile /etc/default/nvidia-glx 195.36.24-1~ -- "$@"
dpkg-maintscript-helper rm_conffile /etc/init.d/nvidia-glx 195.36.24-2 -- "$@"
# </target: squeeze>


case "$1" in
    install|upgrade)

	# the destination directory for the diversions
	test -d /usr/lib/nvidia || \
		mkdir -p /usr/lib/nvidia || true

	# make new diversions
	dpkg-divert --add --rename --package $DPKG_MAINTSCRIPT_PACKAGE --divert \
		/usr/lib/nvidia/libGL.so.1.xlibmesa \
		/usr/lib/libGL.so.1 > /dev/null
	dpkg-divert --add --rename --package $DPKG_MAINTSCRIPT_PACKAGE --divert \
		/usr/lib/nvidia/libGL.so.1.2.xlibmesa \
		/usr/lib/libGL.so.1.2 > /dev/null

	dpkg-divert --add --rename --package $DPKG_MAINTSCRIPT_PACKAGE --divert \
		/usr/lib/nvidia/libglx.so.xlibmesa \
		/usr/lib/xorg/modules/extensions/libglx.so > /dev/null	

	dpkg-divert --add --rename --package $DPKG_MAINTSCRIPT_PACKAGE --divert \
		/usr/lib/nvidia/libGL.so.xlibmesa \
		/usr/lib/libGL.so > /dev/null

    ;;
esac


#DEBHELPER#

exit 0
