Author: Andreas Beckmann <anbe@debian.org>
Description: run conftest.sh from within Kbuild

--- a/nvidia-modules-common.mk
+++ b/nvidia-modules-common.mk
@@ -184,6 +184,7 @@ $(obj)/conftest/patches.h: $(src)/confte
 
 MODULE_GLUE_TARGETS = $(addprefix $(obj)/,$(MODULE_GLUE_OBJS))
 
+$(MODULE_GLUE_TARGETS): build-sanity-checks
 $(MODULE_GLUE_TARGETS): $(CONFTEST_HEADERS)
 
 $(obj)/nv.o: $(obj)/$(VERSION_HEADER)
@@ -258,7 +259,7 @@ ifeq ($(KERNELRELEASE),)
 #
 
 define BUILD_MODULE_RULE
- $(1): build-sanity-checks $(3)
+ $(1): $(3)
 	@echo "NVIDIA: calling KBUILD..."
 	@$$(MAKE) NV_MODULE_SUFFIX=$$(strip $(2)) $$(KBUILD_PARAMS) modules
 	@echo "NVIDIA: left KBUILD."
