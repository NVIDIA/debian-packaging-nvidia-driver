#!/bin/sh

### BEGIN INIT INFO
# Provides:          nvidia-glx
# Required-Start:    $remote_fs
# Required-Stop:     $remote_fs
# Default-Start:     2 3 4 5
# Default-Stop:      
# Short-Description: messing around with the libGL.so symlink
# Description:       messing around with the libGL.so symlink
### END INIT INFO



PATH=/sbin:/usr/sbin:/usr/local/sbin:/bin:/usr/bin:/usr/local/bin
# Load the VERBOSE setting and other rcS variables
. /lib/init/vars.sh

# Define LSB log_* functions.
. /lib/lsb/init-functions


# test if /usr/lib is writable.
if [ ! -w /usr/lib  ]; then
  #we can't change anything so just exit.
  exit 0
fi  


case "$1" in
  start|restart|reload|force-reload)
    rm -f  /usr/lib/libGL.so || true 
    if [ -L /usr/lib/nvidia/libGL.so.xlibmesa ] && [ -d /usr/share/doc/libgl1-mesa-dev ] ; then
    	ln -s /usr/lib/nvidia/libGL.so.1.2.xlibmesa /usr/lib/libGL.so
    fi
    if [ -d /usr/share/doc/nvidia-glx-dev ] ; then
        ln -s /usr/lib/libGL.so.#VERSION# /usr/lib/libGL.so
    fi
    ;;

  stop) 
    :
    ;;

  *)
    echo "Usage: /etc/init.d/nvidia-glx {start|stop|restart|reload|force-reload}"
    exit 1
    ;;
esac
	
exit 0
